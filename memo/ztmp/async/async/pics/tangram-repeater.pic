.PS
linewid = linewid * 0.7
   # gen_init: Gpic m4 macro settings used.
   rp_ang = 0
   rtod_ = 57.295779513082323
   dtor_ = 0.017453292519943295
   linethick = 0.8
  arrowwid = 0.05*scale; arrowht = 0.1*scale
   
   
   
N: [ [ line from ((linewid/10)*(7/3)+((linewid/10)*(3))*(-0),(linewid/10)*(3)) to (((linewid/10)*(3))*(-0),(linewid/10)*(3))
  arc cw from (((linewid/10)*(3))*(-0),(linewid/10)*(3)) to (((linewid/10)*(-3))*(-0),(linewid/10)*(-3)) \
    with .c at ((linewid/10)*(-sqrt(7^2-3^2)),0)
  line from (((linewid/10)*(-3))*(-0),(linewid/10)*(-3)) to ((linewid/10)*(7/3)+((linewid/10)*(-3))*(-0),(linewid/10)*(-3))
  arc  cw from ((linewid/10)*(7/3)+((linewid/10)*(3))*(-0),(linewid/10)*(3)) to ((linewid/10)*(7),0) \
     with .c at ((linewid/10)*(7/3)+((linewid/10)*(-((7*2/3)^2-3^2)/2/3))*(-0),(linewid/10)*(-((7*2/3)^2-3^2)/2/3))
  arc ccw from ((linewid/10)*(7/3)+((linewid/10)*(-3))*(-0),(linewid/10)*(-3)) to ((linewid/10)*(7),0) \
     with .c at ((linewid/10)*(7/3)+((linewid/10)*(((7*2/3)^2-3^2)/2/3))*(-0),(linewid/10)*(((7*2/3)^2-3^2)/2/3))
  
  
  
  
Out: ((linewid/10)*(7),0)
  ] with .Out at ((linewid/10)*(7),0)
  circle diam linewid/10*3/2 at ((linewid/10)*(7+3/2/2),0)
Out: ((linewid/10)*(7+3/2),0)
  
  
   
    In1: ((linewid/10)*(-sqrt(7^2-3^2)+sqrt(7^2-(3/min(2,6-1)*(2+1-2*1))^2))+((linewid/10)*(3/min(2,6-1)*(2+1-2*1)))*(-0),(linewid/10)*(3/min(2,6-1)*(2+1-2*1)))
    
    
   
    In2: ((linewid/10)*(-sqrt(7^2-3^2)+sqrt(7^2-(3/min(2,6-1)*(2+1-2*2))^2))+((linewid/10)*(3/min(2,6-1)*(2+1-2*2)))*(-0),(linewid/10)*(3/min(2,6-1)*(2+1-2*2)))
    
    
  
  
  ]
 line   right linewid/10*6 from N.Out ; "\hbox{$\:$}$b_r$" ljust
 line   left linewid/10*3 from N.In1
 line   up linewid/10*6 from Here
 line   right linewid/10*17 from Here ; "\hbox{$\:$}$b_a$" ljust
 move   left linewid/10*9 from N.In1
 move   up linewid/10*2 from Here
 line   left linewid/10*5 from Here
 move   right linewid/10*2.5 from Here
 line   up linewid/10*4 from Here
 line   left linewid/10*8 from Here ; "$a_a$\hbox{$\:$}" rjust
   right
I: [[ line from ((linewid/10)*(3.5),0) to (((linewid/10)*(-4/2))*(-0),(linewid/10)*(-4/2)) then to (((linewid/10)*(4/2))*(-0),(linewid/10)*(4/2)) \
       then to ((linewid/10)*(3.5),0)
    
   In1: (((linewid/10)*(2*3/min(1,6-1)*((1+1)/2-1)))*(-0),(linewid/10)*(2*3/min(1,6-1)*((1+1)/2-1))) 
   
  Out: ((linewid/10)*(3.5),0) ] with .Out at ((linewid/10)*(3.5),0)
  circle diam linewid/10*3/2 at ((linewid/10)*(3.5+3/2/2),0)
  Out: ((linewid/10)*(3.5+3/2),0)
   
   In1: (((linewid/10)*(2*3/min(1,6-1)*((1+1)/2-1)))*(-0),(linewid/10)*(2*3/min(1,6-1)*((1+1)/2-1))) 
    ] at N+(-linewid/10*15,-1.5*linewid/10) 
 line   left linewid/10*6 from I.In1 ; "$a_r$\hbox{$\:$}" rjust
 move to I.Out
 line   right linewid/10*6 to N.In2 
.PE